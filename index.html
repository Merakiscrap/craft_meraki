<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Meraki - Souvenirs uniques</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- MENU -->
<div id="menu-container"></div>

<!-- HERO -->
<main class="container">
  <section class="hero">
    <h1 id="heroTitle"></h1>
    <p class="meraki-story" id="merakiStory"></p>
    <a href="galerie.html" class="btn-portfolio" id="portfolioButton"></a>
  </section>

  <!-- CERCLES OFFRES -->
  <section class="circle-offers" id="previewOffers"></section>
</main>

<!-- FOOTER -->
<div id="footer-container"></div>

<!-- SCRIPTS -->
<script src="js/load-components.js"></script>
<script src="js/content.js"></script>

<script>
const mobileBreakpoint = 768;
let lastScroll = 0;

// Wait until header is loaded
const waitForHeader = setInterval(() => {
  const header = document.querySelector('header');
  const logo = document.querySelector('.logo img');
  const nav = document.querySelector('nav');
  const menuLinks = document.querySelectorAll('nav ul li a');

  if (header && logo && nav) {
    clearInterval(waitForHeader);

    // Mobile hide-on-scroll
    window.addEventListener('scroll', () => {
      if (window.innerWidth <= mobileBreakpoint) {
        const currentScroll = window.pageYOffset;
        if (currentScroll > lastScroll) {
          header.style.top = `-${header.offsetHeight}px`;
        } else {
          header.style.top = '0';
        }
        lastScroll = currentScroll;
      }
    });

  // Hover only works on desktop
logo.addEventListener('mouseenter', () => {
  if (window.innerWidth > mobileBreakpoint) {
    nav.classList.add('open');
  }
});
nav.addEventListener('mouseleave', () => {
  if (window.innerWidth > mobileBreakpoint) {
    nav.classList.remove('open');
  }
});

// Click always works, but only toggles on mobile
logo.addEventListener('click', (e) => {
  if (window.innerWidth <= mobileBreakpoint) {
    e.preventDefault();
    nav.classList.toggle('open');
  }
});


    // Close menu when clicking a link on mobile
    menuLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (window.innerWidth <= mobileBreakpoint) nav.classList.remove('open');
      });
    });
  }
}, 50);

  /* language switch code */
  const waitForMenu = setInterval(() => {
  const langSwitch = document.getElementById('langSwitch');
  if (langSwitch) {
    clearInterval(waitForMenu);

    let langue = 'fr'; // default

    const updateContent = (lang) => {
      fetch(`assets/translations/content-${lang}.json`)
        .then(resp => resp.json())
        .then(data => {
          const heroTitle = document.getElementById('heroTitle');
          const merakiStory = document.getElementById('merakiStory');
          const portfolioButton = document.getElementById('portfolioButton');
          const previewOffers = document.getElementById('previewOffers');

          if(heroTitle) heroTitle.innerText = data.heroTitle;
          if(merakiStory) merakiStory.innerHTML = data.merakiStory;
          if(portfolioButton){
            portfolioButton.innerText = data.portfolioButton;
            portfolioButton.href = "galerie.html";
          }
          if(previewOffers){
            previewOffers.innerHTML = '';
            data.previewOffers.forEach(offer=>{
              const circle = document.createElement('a');
              circle.href = offer.link;
              circle.className = 'circle';
              circle.innerHTML = `<span class="title">${offer.title}</span><span class="subtitle">${offer.text}</span>`;
              previewOffers.appendChild(circle);
            });
          }
        });
    };

    // Initial load
    updateContent(langue);

    // Click event
    langSwitch.addEventListener('click', e => {
      e.preventDefault();
      langue = (langue === 'fr') ? 'en' : 'fr';
      langSwitch.innerText = (langue === 'fr') ? 'EN' : 'FR';
      updateContent(langue);
    });
  }
}, 50);

</script>

</body>
</html>


