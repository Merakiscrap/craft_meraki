<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Meraki - Contact</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>

<!-- MENU -->
<div id="menu-container"></div>

<main class="container">
  <h1 id="contactTitle"></h1>
  <p id="contactDescription"></p>

  <form class="contact-form" action="#" method="POST">
    <label id="labelName" for="name"></label>
    <input type="text" id="name" name="name" required />
    
    <label id="labelEmail" for="email"></label>
    <input type="email" id="email" name="email" required />
    
    <label id="labelSubject" for="subject"></label>
    <input type="text" id="subject" name="subject" />
    
    <label id="labelMessage" for="message"></label>
    <textarea id="message" name="message" rows="6" required></textarea>
    
    <button type="submit" id="contactButton"></button>
  </form>
</main>

<!-- FOOTER -->
<div id="footer-container"></div>

<!-- SCRIPTS -->
<script src="js/load-components.js"></script>
<script src="js/content.js"></script>

<script>
const mobileBreakpoint = 768;
let lastScroll = 0;

// Wait for header/menu
const waitForHeader = setInterval(() => {
  const header = document.querySelector('header');
  const logo = document.querySelector('.logo img');
  const nav = document.querySelector('nav');
  const menuLinks = document.querySelectorAll('nav ul li a');
  const langSwitch = document.getElementById('langSwitch');

  if(header && logo && nav && langSwitch){
    clearInterval(waitForHeader);

    // MOBILE: hide-on-scroll
    window.addEventListener('scroll', () => {
      if(window.innerWidth <= mobileBreakpoint){
        const currentScroll = window.pageYOffset;
        if(currentScroll > lastScroll){
          header.style.top = `-${header.offsetHeight}px`;
        } else {
          header.style.top = '0';
        }
        lastScroll = currentScroll;
      }
    });

    // DESKTOP: hover menu
    if(window.innerWidth > mobileBreakpoint){
      logo.addEventListener('mouseenter', () => nav.classList.add('open'));
      nav.addEventListener('mouseleave', () => nav.classList.remove('open'));
    }

    // MOBILE: click menu toggle
    logo.addEventListener('click', e => {
      if(window.innerWidth <= mobileBreakpoint){
        e.preventDefault();
        nav.classList.toggle('open');
      }
    });

    // Close menu on mobile link click
    menuLinks.forEach(link => {
      link.addEventListener('click', () => {
        if(window.innerWidth <= mobileBreakpoint) nav.classList.remove('open');
      });
    });

    // LANGUAGE SWITCH
    let langue = 'fr';
    const updateContent = lang => {
      fetch(`assets/translations/content-${lang}.json`)
        .then(resp => resp.json())
        .then(data => {
          if(data.contact){
            document.getElementById('contactTitle').innerText = data.contact.contactTitle;
            document.getElementById('contactDescription').innerText = data.contact.contactDescription;
            document.getElementById('labelName').innerText = data.contact.labelName;
            document.getElementById('labelEmail').innerText = data.contact.labelEmail;
            document.getElementById('labelSubject').innerText = data.contact.labelSubject;
            document.getElementById('labelMessage').innerText = data.contact.labelMessage;
            document.getElementById('contactButton').innerText = data.contact.contactButton;
          }
        });
    };

    updateContent(langue);

    langSwitch.addEventListener('click', e => {
      e.preventDefault();
      langue = (langue === 'fr') ? 'en' : 'fr';
      langSwitch.innerText = (langue === 'fr') ? 'EN' : 'FR';
      updateContent(langue);
    });

  }
}, 50);
</script>

</body>
</html>
