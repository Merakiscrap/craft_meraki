<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Meraki - Contact</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- MENU -->
<div id="menu-container"></div>

<!-- CONTACT FORM -->
<main class="container">
  <h1 id="contactTitle"></h1>
  <p id="contactDescription"></p>

  <form class="contact-form" action="#" method="POST">
    <label for="name" id="labelName"></label>
    <input type="text" id="name" name="name" required />

    <label for="email" id="labelEmail"></label>
    <input type="email" id="email" name="email" required />

    <label for="subject" id="labelSubject"></label>
    <input type="text" id="subject" name="subject" />

    <label for="message" id="labelMessage"></label>
    <textarea id="message" name="message" rows="6" required></textarea>

    <button type="submit" id="contactButton"></button>
  </form>
</main>

<!-- FOOTER -->
<div id="footer-container"></div>

<!-- SCRIPTS -->
<script src="js/load-components.js"></script>
<script src="js/content.js"></script>
<script>
const mobileBreakpoint = 768;
let lastScroll = 0;

// Wait until menu is loaded
const waitForHeader = setInterval(() => {
  const header = document.querySelector('header');
  const logo = document.querySelector('.logo img');
  const nav = document.querySelector('nav');
  const menuLinks = document.querySelectorAll('nav ul li a');

  if (header && logo && nav) {
    clearInterval(waitForHeader);

    // Mobile: hide header on scroll
    window.addEventListener('scroll', () => {
      if (window.innerWidth <= mobileBreakpoint) {
        const currentScroll = window.pageYOffset;
        header.style.top = (currentScroll > lastScroll) ? `-${header.offsetHeight}px` : '0';
        lastScroll = currentScroll;
      }
    });

    // Desktop: show menu on hover
    if (window.innerWidth > mobileBreakpoint) {
      logo.addEventListener('mouseenter', () => nav.classList.add('open'));
      nav.addEventListener('mouseleave', () => nav.classList.remove('open'));
    }

    // Mobile: toggle menu on logo click
    logo.addEventListener('click', (e) => {
      if (window.innerWidth <= mobileBreakpoint) {
        e.preventDefault();
        nav.classList.toggle('open');
      }
    });

    // Close mobile menu on link click
    menuLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (window.innerWidth <= mobileBreakpoint) nav.classList.remove('open');
      });
    });
  }
}, 50);

// LANGUAGE SWITCH
const waitForMenu = setInterval(() => {
  const langSwitch = document.getElementById('langSwitch');
  if (langSwitch) {
    clearInterval(waitForMenu);

    let langue = 'fr'; // default

    const updateContent = (lang) => {
      fetch(`assets/translations/content-${lang}.json`)
        .then(resp => resp.json())
        .then(data => {
          document.getElementById('contactTitle').innerText = data.contactTitle;
          document.getElementById('contactDescription').innerText = data.contactDescription;
          document.getElementById('labelName').innerText = data.labelName;
          document.getElementById('labelEmail').innerText = data.labelEmail;
          document.getElementById('labelSubject').innerText = data.labelSubject;
          document.getElementById('labelMessage').innerText = data.labelMessage;
          document.getElementById('contactButton').innerText = data.contactButton;
        });
    };

    // Initial load
    updateContent(langue);

    // Click to switch language
    langSwitch.addEventListener('click', e => {
      e.preventDefault();
      langue = (langue === 'fr') ? 'en' : 'fr';
      langSwitch.innerText = (langue === 'fr') ? 'EN' : 'FR';
      updateContent(langue);
    });
  }
}, 50);
</script>

</body>
</html>
